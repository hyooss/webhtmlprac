<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>home</title>
    <style>
        h1 {
            font-style: italic;
            font-weight: bold;
            color: black;
            background-color: red;
            width: 1000px;
        }

        #buttonContainer{
            width: 1000px;
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
        }

        .selected {
            background-color: cornflowerblue;
            color: white;
        }
    </style>
</head>
<body>
<h1>HOME</h1>
<p>이곳은 홈화면입니다</p>
<div id="buttonContainer">
    <!-- 버튼 1~100 생성됨 -->
</div>
<p>선택된 버튼: <span id="selectedDisplay"></span></p>
<p>기록: <span id="histories"></span></p>
<p>
    <button id="backBtn">&larr;</button>
    <button id="forwardBtn">&rarr;</button>
</p>
<!--<script src="/script.js" defer></script>-->
<script type="module" >
    import {Subject, Observer} from "/ObsPattern.js";


    class ButtonMediator extends Subject
    {
        constructor() {
            super();
            this.histories = [];
        }

        addClickHistory(observer) {

            // contains same  observer, dont push
            if(!this.histories.includes(observer)) {
                this.histories.push(observer)
            }
            this.notifyObservers(this.histories)
        }
    }

    class Button extends Observer
    {
        constructor(element) {
            super(element);
        }
        update(dataList) {
            // getLast element
            const data = dataList[dataList.length - 1];

            console.log(dataList);
            if(data === this)
            {
                this.activeVew()
            }
            else
            {
                this.defaultView();
            }
        }

        defaultView(){
            this.element.classList.remove("selected");
        }

        activeVew()
        {
            this.element.classList.add("selected");
        }
    }

    const subject = new ButtonMediator();
    const buttonContainer = document.getElementById("buttonContainer");

    for (let i = 1; i <= 100; i++) {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.textContent = i.toString();
        buttonContainer.appendChild(btn);


        const observer = new Button(btn)
        btn.onclick = (() => {
            subject.addClickHistory(observer);
        })
        subject.addObserver(observer)
    }
</script>

</body>
</html>